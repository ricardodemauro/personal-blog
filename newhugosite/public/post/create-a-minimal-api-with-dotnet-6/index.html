<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Create a Minimal API with .NET 6 | rmauro.dev {blog}</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="One of the new features of .NET 6 is the arrival of a new template, which will replace the default and bring a good reduction in code writing. Including the removal of the Startup.cs file.
.NET 6 was released as LTS (long-term stable) which means support for 3 years. So we have to learn about this new baby. Don&rsquo;t forget the new C# 10 features as well.
Minimal APIs are architected to create HTTP APIs with minimal dependencies.">
    <meta name="generator" content="Hugo 0.130.0">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/post/create-a-minimal-api-with-dotnet-6/">
    

    <meta property="og:url" content="http://localhost:1313/post/create-a-minimal-api-with-dotnet-6/">
  <meta property="og:site_name" content="rmauro.dev {blog}">
  <meta property="og:title" content="Create a Minimal API with .NET 6">
  <meta property="og:description" content="One of the new features of .NET 6 is the arrival of a new template, which will replace the default and bring a good reduction in code writing. Including the removal of the Startup.cs file.
.NET 6 was released as LTS (long-term stable) which means support for 3 years. So we have to learn about this new baby. Don’t forget the new C# 10 features as well.
Minimal APIs are architected to create HTTP APIs with minimal dependencies.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2022-07-04T20:16:53+00:00">
    <meta property="article:modified_time" content="2022-07-04T20:16:53+00:00">
    <meta property="article:tag" content="C#">
    <meta property="article:tag" content=".NET 6">
    <meta property="article:tag" content="DotNet">

  <meta itemprop="name" content="Create a Minimal API with .NET 6">
  <meta itemprop="description" content="One of the new features of .NET 6 is the arrival of a new template, which will replace the default and bring a good reduction in code writing. Including the removal of the Startup.cs file.
.NET 6 was released as LTS (long-term stable) which means support for 3 years. So we have to learn about this new baby. Don’t forget the new C# 10 features as well.
Minimal APIs are architected to create HTTP APIs with minimal dependencies.">
  <meta itemprop="datePublished" content="2022-07-04T20:16:53+00:00">
  <meta itemprop="dateModified" content="2022-07-04T20:16:53+00:00">
  <meta itemprop="wordCount" content="1070">
  <meta itemprop="keywords" content="C#,.NET 6,DotNet">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Create a Minimal API with .NET 6">
  <meta name="twitter:description" content="One of the new features of .NET 6 is the arrival of a new template, which will replace the default and bring a good reduction in code writing. Including the removal of the Startup.cs file.
.NET 6 was released as LTS (long-term stable) which means support for 3 years. So we have to learn about this new baby. Don’t forget the new C# 10 features as well.
Minimal APIs are architected to create HTTP APIs with minimal dependencies.">

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        rmauro.dev {blog}
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Create a Minimal API with .NET 6</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2022-07-04T20:16:53Z">July 4, 2022</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>One of the new features of .NET 6 is the arrival of a new template, which will replace the default and bring a good reduction in code writing. Including the removal of the <em>Startup.cs</em> file.</p>
<p>.NET 6 was <a href="https://devblogs.microsoft.com/dotnet/announcing-net-6/">released</a> as LTS (long-term stable) which means support for 3 years. So we have to learn about this new baby. Don&rsquo;t forget the new C# 10 features as well.</p>
<blockquote>
<p>Minimal APIs are architected to create HTTP APIs with minimal dependencies. They are ideal for microservices and apps that want to include only the minimum files, features, and dependencies in ASP.NET Core.<em><strong>microsoft.com</strong></em></p>
</blockquote>
<h2 id="-in-this-issue">💬 In this issue</h2>
<p>In this tutorial we&rsquo;re going to create the following endpoints:</p>
<table>
	<thead style="font-weight: bold;">
        <tr>
			<th>API</th>
			<th>Description</th>
			<th>Request</th>
			<th>Response</th>
       </tr>
	</thead>
	<tbody>
		<tr>
			<td>GET /</td>
			<td>Landing Page</td>
			<td>N/A</td>
			<td>HTML Page</td>
		</tr>
		<tr>
			<td>GET /{chunck}</td>
			<td>Route to redirect</td>
			<td>Chunk</td>
			<td>HTTP Redirect to final</td>
		</tr>
		<tr>
			<td>POST /urls</td>
			<td>Create a new resource</td>
			<td>{ "url": "https://..." }</td>
			<td>Created Resource</td>
		</tr>
	</tbody>
</table>
<h3 id="before-we-get-started---dependencies">Before we get started - Dependencies</h3>
<p>Before getting started you need to have installed .<strong>NET6 SDK</strong><a href="https://dotnet.microsoft.com/en-us/download">https://dotnet.microsoft.com/en-us/download</a></p>
<h3 id="create-the-minimal-api-project">Create the Minimal API project</h3>
<p>To get started let&rsquo;s create our project using the new template. Run the following code in your terminal.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dotnet new web -o URLShortnerMinimalApi
</span></span></code></pre></div><p>Once run and completed, open it with <em>Visual Studio</em> or <em>Visual Studio Code</em>.You will come across only one file called <code>Program.cs</code> with the following content:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> builder = WebApplication.CreateBuilder(args);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> app = builder.Build();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.MapGet(<span style="color:#e6db74">&#34;/&#34;</span>, () =&gt; <span style="color:#e6db74">&#34;Hello World&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.Run();
</span></span></code></pre></div><p>This is a perfect and ready-to-run application.</p>
<h3 id="creating-a-record">Creating a Record</h3>
<p>C# 9 introduced a new type of data structure, called <em>Record</em>, which allows you to have object resources in simpler structures.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">class</span> ShortUrl(<span style="color:#66d9ef">string</span> Url)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Guid Id { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string?</span> Chunck { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The <em>ShortUrl</em> record is defined with:</p>
<ul>
<li>Url it&rsquo;s mandatory in his constructor and <em>Get</em> only property</li>
<li>Id is not a mandatory property</li>
<li>Chunk is not a mandatory property</li>
</ul>
<p>The next step is to set up our database access. For that, we&rsquo;ll use <a href="https://www.litedb.org/">LiteDb</a> - A Embedded NoSQL database for .NET.</p>
<h3 id="set-up-database---lite-db">Set up Database - Lite DB</h3>
<p>To make use of LiteDb we must add it NuGet package. To do so run the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dotnet add package LiteDB
</span></span></code></pre></div><p>After including the new package let&rsquo;s add it to our <em>Dependency Injection</em> container.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> LiteDB;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> builder = WebApplication.CreateBuilder(args);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//you could also get it from IConfiguration interface</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> connectionString = <span style="color:#e6db74">&#34;short.db&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//add as a singleton - it&#39;s a single file with a single access point</span>
</span></span><span style="display:flex;"><span>builder.Services.AddSingleton&lt;ILiteDatabase, LiteDatabase&gt;(
</span></span><span style="display:flex;"><span>   x =&gt; <span style="color:#66d9ef">new</span> LiteDatabase(connectionString));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> app = builder.Build();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//redacted</span>
</span></span></code></pre></div><p>Database access: Checked!</p>
<h3 id="http-get---redirect-to-final-url">HTTP GET - Redirect to final Url</h3>
<p>Now we can use it to build our first API endpoint.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">//redacted</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> app = builder.Build();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.MapGet(<span style="color:#e6db74">&#34;/&#34;</span>, () =&gt; <span style="color:#e6db74">&#34;Hello World!&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.MapGet(<span style="color:#e6db74">&#34;/{chunck}&#34;</span>, (<span style="color:#66d9ef">string</span> chunck, ILiteDatabase db) =&gt;
</span></span><span style="display:flex;"><span>    db.GetCollection&lt;ShortUrl&gt;().FindOne(x =&gt; x.Chunck == chunck)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">is</span> ShortUrl url
</span></span><span style="display:flex;"><span>    ? Results.Redirect(url.Url)
</span></span><span style="display:flex;"><span>    : Results.NotFound());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.Run();
</span></span></code></pre></div><p>Note that we&rsquo;re using <em>Pattern Matching</em> - a new C# feature - to compare if the return is an instance of <code>ShortUrl</code>.This comparison allows us to return <code>Results.Redirect</code> (redirect to the final destination) or <code>Results.NotFound</code>.</p>
<p>Redirect route to target Url: Checked!</p>
<h3 id="creating-chunks-for-a-unique-identifier">Creating Chunks for a unique identifier</h3>
<p>To generate new chunks we&rsquo;re going to use the package NanoId. We could use GUID, but it&rsquo;s ugly and too big for the end-user.</p>
<p>Note: This library doesn&rsquo;t guarantee that will be a unique generated Id every time - Let&rsquo;s use it just for fun.</p>
<p>Add the NanoId package to our project. Run the following command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dotnet add package NanoId
</span></span></code></pre></div><h3 id="http-post---create-a-new-resource">HTTP POST - Create a new resource</h3>
<p>Let&rsquo;s create an endpoint to create a new resource.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>app.MapPost(<span style="color:#e6db74">&#34;/urls&#34;</span>, (ShortUrl shortUrl, HttpContext ctx, ILiteDatabase db) =&gt;
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//check if is a valid url</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (Uri.TryCreate(shortUrl.Url, UriKind.RelativeOrAbsolute
</span></span><span style="display:flex;"><span>       , <span style="color:#66d9ef">out</span> Uri? parsedUri))
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//generates a random value</span>
</span></span><span style="display:flex;"><span>        shortUrl.Chunck = Nanoid.Nanoid.Generate(size: <span style="color:#ae81ff">9</span>);
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//inserts new record in the database</span>
</span></span><span style="display:flex;"><span>        db.GetCollection&lt;ShortUrl&gt;(BsonAutoId.Guid).Insert(shortUrl);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> rawShortUrl = <span style="color:#e6db74">$&#34;{ctx.Request.Scheme}://{ctx.Request.Host}/{shortUrl.Chunck}&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Results.Ok(<span style="color:#66d9ef">new</span> { ShortUrl = rawShortUrl });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Results.BadRequest(<span style="color:#66d9ef">new</span> { ErrorMessage = <span style="color:#e6db74">&#34;Invalid Url&#34;</span> });
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>In this endpoint, the first thing we do is check if the URL sent is valid. We could use something fancier, but for sake of simplicity let&rsquo;s use this simple check.</p>
<p>When is <strong>Good</strong> we go ahead and create a new record in the database and return an anonymous object <code>{ ShortUrl = &quot;Generated URL&quot; }</code></p>
<p>When is <strong>Bad</strong> Url them we return <code>Results.BadRequest</code> - HTTP Status 400 - with another anonymous object with a single property called <code>ErrorMessage</code> and the message itself.</p>
<p>Route to create new Short Urls: Checked!</p>
<h3 id="adding-a-frontend-for-the-end-user">Adding a frontend for the end-user</h3>
<p>Let&rsquo;s add a frontend for the user can call our APIs to generate new <em>short-urls</em>.</p>
<p>Create the folder <code>wwwroot</code>and a file <code>index.html</code> inside of it with the following content.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">title</span>&gt;Url Shortner .NET 6&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://unpkg.com/mvp.css&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">header</span>&gt;&lt;<span style="color:#f92672">h1</span>&gt;Welcome to Url Shortner with .NET 6&lt;/<span style="color:#f92672">h1</span>&gt;&lt;/<span style="color:#f92672">header</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">main</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">section</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">aside</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width: 25rem;&#34;</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>                    Enter the url
</span></span><span style="display:flex;"><span>                    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;url&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;url&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width: 22rem; margin: 0.5rem 0&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>                &lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;button&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;btnSubmit&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;padding: 0.5rem 1rem&#34;</span>&gt;Submit&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">p</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;urlResult&#34;</span>&gt;&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;/<span style="color:#f92672">aside</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">section</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">main</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>        document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;btnSubmit&#39;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;click&#39;</span>, <span style="color:#a6e22e">e</span> =&gt; {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">preventDefault</span>();
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">handleSubmitAsync</span>();
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;url&#39;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;keyup&#39;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">evt</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">evt</span>.<span style="color:#a6e22e">code</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;Enter&#39;</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">preventDefault</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">handleSubmitAsync</span>();
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">handleSubmitAsync</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;url&#39;</span>).<span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">json</span> <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#39;url&#39;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">url</span> };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">headers</span> <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#39;content-type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span> };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;/urls&#39;</span>, { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;post&#39;</span>, <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">json</span>), <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">headers</span> })
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">apiResult</span> =&gt; {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Promise(<span style="color:#a6e22e">resolve</span> =&gt; <span style="color:#a6e22e">apiResult</span>.<span style="color:#a6e22e">json</span>()
</span></span><span style="display:flex;"><span>                        .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">json</span> =&gt; <span style="color:#a6e22e">resolve</span>({ <span style="color:#a6e22e">ok</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">apiResult</span>.<span style="color:#a6e22e">ok</span>, <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">apiResult</span>.<span style="color:#a6e22e">status</span>, <span style="color:#a6e22e">json</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">json</span> }))
</span></span><span style="display:flex;"><span>                    );
</span></span><span style="display:flex;"><span>                })
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">then</span>(({ <span style="color:#a6e22e">json</span>, <span style="color:#a6e22e">ok</span>, <span style="color:#a6e22e">status</span> }) =&gt; {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">ok</span>) {
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">anchor</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`&lt;a href=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">shortUrl</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> target=&#34;_blank&#34;&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">shortUrl</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/a&gt;`</span>;
</span></span><span style="display:flex;"><span>                        document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;urlResult&#39;</span>).<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">anchor</span>;
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">alert</span>(<span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">errorMessage</span>);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>Last but not least, set up an endpoint to return the file as <em>HTML</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>app.MapGet(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">async</span> (HttpContext ctx) =&gt;
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//sets the content type as html</span>
</span></span><span style="display:flex;"><span>    ctx.Response.Headers.ContentType = <span style="color:#66d9ef">new</span> Microsoft.Extensions.Primitives.StringValues(<span style="color:#e6db74">&#34;text/html; charset=UTF-8&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> ctx.Response.SendFileAsync(<span style="color:#e6db74">&#34;wwwroot/index.html&#34;</span>);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>Now accessing the path &ldquo;/&rdquo; endpoint will run this code and send the HTML to the end-user.</p>
<p>Note 1: It&rsquo;s important to set the <em>Content-Type</em> as &ldquo;text/html; charset=UTF-8&rdquo;. Otherwise, the browser will display it as simple text (show the Html code).Note 2: Don&rsquo;t forget to delete the previous route &ldquo;/&rdquo; that returns &ldquo;Hello World&rdquo;.</p>
<p>Frontend to end-user: Checked!</p>
<h3 id="testing">Testing</h3>
<p>Run the application. The page should be displayed as follow.</p>
<figure><img src="https://res-3.cloudinary.com/dgoa5llvh/image/upload/q_auto/v1/ghost-blog-images/short-landingpage.png"
    alt="Url Shortner Landing Page"><figcaption>
      <p>Url Shortner Landing Page</p>
    </figcaption>
</figure>

<h3 id="source-code---follow-me-on-github-too">Source Code - Follow me on Github too</h3>
<figure class="kg-card kg-bookmark-card">
  <a href="https://github.com/ricardodemauro/URLShortnerMinimalApi" class="kg-bookmark-container">
    <div class="kg-bookmark-content">
      <div class="kg-bookmark-title">GitHub - ricardodemauro/URLShortnerMinimalApi</div>
      <div class="kg-bookmark-description">Contribute to ricardodemauro/URLShortnerMinimalApi development by creating an account on GitHub.</div>
      <div class="kg-bookmark-metadata">
        <img src="https://github.githubassets.com/favicons/favicon.svg" class="kg-bookmark-icon">
        <span class="kg-bookmark-author">ricardodemauro</span>
        <span class="kg-bookmark-publisher">GitHub</span>
      </div>
    </div>
    
    <div class="kg-bookmark-thumbnail">
      <img src="https://opengraph.githubassets.com/75f12c501f014a3758ce7ac6f9d9f6b33888c69d1e60df5f61a908f4fba73262/ricardodemauro/URLShortnerMinimalApi">
    </div>
    
  </a>
  
</figure>
<h2 id="-enjoy-this-article">❤️ Enjoy this article?</h2>
<p><strong>Forward to a friend</strong> and let them know.</p>
<ul class="pa0">
  
   <li class="list di">
     <a href="/tags/C%23/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">C#</a>
   </li>
  
   <li class="list di">
     <a href="/tags/.NET-6/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">.NET 6</a>
   </li>
  
   <li class="list di">
     <a href="/tags/DotNet/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">DotNet</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/post/setup-serilog-in-net6-as-logging-provider/">Set up Serilog in .NET 6 as a logging provider</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/adding-health-checks-to-net-core-application/">Health Checks on your ASP.NET Core Application</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/adding-startup-back-to-net-6-project/">Adding Startup.cs back to .NET 6 Project</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/add-build-time-to-your-csharp-assembly/">Add Build Time to your C# Assembly</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/optmizing-data-access-with-oracle-managed-ado-net/">Optimizing Query Performance on C# ODP.NET - Oracle Managed Data Access</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/health-checks-em-aplicacoes-net-5/">Health Checks em Aplicações .NET 5</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/api-key-authentication-extending-the-native-implementation/">API Key Authentication - Extending the native implementation</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/end-to-end-csharp-application-with-dotnet-5-api-and-mongo-db/">End to end C# Application with .NET 5 API and MongoDB</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/native-dependency-injection-in-azure-functions-with-csharp/">Native Dependency Injection in Azure Functions with C#</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/adding-health-checks-ui/">Adding Health Checks UI</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/enabling-http-2-on-kestrel/">Simple Web Application with HTTP 2 over Kestrel</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/compress-zip-files-in-memory-using-csharp/">Compress files in memory (.zip) using C#</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/getting-the-file-name-without-extenion-in-csharp/">Getting the file name without extension in C# - #TIP</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/azure-function-v3-com-entityframework-core-3-1/">Azure Function V3 com EntityFramework Core 3.1</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/post/aspnetcore-com-mongo-db-e-mongo-atlas/">Asp.Net Core com MongoDb e Mongo Atlas - C#</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  rmauro.dev {blog} 2024 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
